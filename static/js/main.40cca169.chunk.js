(this["webpackJsonpturnip-market-frt"]=this["webpackJsonpturnip-market-frt"]||[]).push([[0],{1:function(e,t,n){e.exports={wrapper:"Block_wrapper__-CBNt",element:"Block_element__3XqcY",button:"Block_button__GrK9h"}},11:function(e,t,n){e.exports=n(18)},16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),u=n.n(c),o=(n(16),n(4)),s=n(1),i=n.n(s),l=function(e){var t=e.setPseudo,n=Object(a.useState)(""),c=Object(o.a)(n,2),u=c[0],s=c[1];return r.a.createElement("div",{className:i.a.wrapper},r.a.createElement("input",{type:"text",placeholder:"Enter your pseudo",onChange:function(e){return s(e.target.value)},className:i.a.element}),r.a.createElement("button",{onClick:function(){return t(u)},className:"".concat(i.a.element," ").concat(i.a.button)},"OK"))},p=n(10),m=n(2),f=n.n(m),d=n(3),v=function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a,r,c,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://turnip-market-api.herokuapp.com/api/v1","/markets/"),{method:"POST",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,r=a.id,c=a.name,u=a.activeOffers,e.abrupt("return",{id:r,name:c,activeOffers:u});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a,r,c,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://turnip-market-api.herokuapp.com/api/v1","/markets/").concat(t),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if(404!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.json();case 7:return a=e.sent,r=a.id,c=a.name,u=a.activeOffers,e.abrupt("return",{id:r,name:c,activeOffers:u});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(d.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://turnip-market-api.herokuapp.com/api/v1","/markets/").concat(t,"/offers"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(e){var t=e.addMarketId,n=Object(a.useState)(),c=Object(o.a)(n,2),u=c[0],s=c[1],l=Object(a.useState)(),p=Object(o.a)(l,2),m=p[0],h=p[1],b=function(){var e=Object(d.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(u);case 2:n=e.sent,t(n.id);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("div",{className:i.a.wrapper},r.a.createElement("input",{type:"text",placeholder:"New market name",onChange:function(e){return s(e.target.value)},className:i.a.element}),r.a.createElement("button",{onClick:b,className:"".concat(i.a.element," ").concat(i.a.button)},"Create new market")),r.a.createElement("div",{className:i.a.wrapper},r.a.createElement("input",{type:"text",placeholder:"Existing market ID",onChange:function(e){return h(e.target.value)},className:i.a.element}),r.a.createElement("button",{onClick:function(){return t(m)},className:"".concat(i.a.element," ").concat(i.a.button)},"Join existing market")))},E=function(e){var t=e.market;return r.a.createElement("div",null,r.a.createElement("h4",null,t.name," (",t.id,")"),t.activeOffers.length>0&&r.a.createElement("ul",null,t.activeOffers.map((function(e){return r.a.createElement("li",{key:e.player},r.a.createElement("div",null,e.price," bells"),r.a.createElement("div",null,"@",e.player))}))),0===t.activeOffers.length&&r.a.createElement("strong",null,"no active offers!"))},O=function(e){var t=e.pseudo,n=e.marketIds,c=e.refreshMarkets,u=Object(a.useState)(0),s=Object(o.a)(u,2),l=s[0],p=s[1],m=function(){var e=Object(d.a)(f.a.mark((function e(){var a,r,u,o,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Date,r=a.getHours()<12,u=new Date,o=new Date,r?(u.setHours(8,0,0,0),o.setHours(12,0,0,0)):(u.setHours(12,0,0,0),o.setHours(22,0,0,0)),s={player:t,price:l,startTime:u,endTime:o},e.next=8,Promise.all(n.map(function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t,s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:c();case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:i.a.wrapper},r.a.createElement("input",{type:"number",placeholder:"$$$$",onChange:function(e){return p(parseInt(e.target.value))},className:i.a.element}),r.a.createElement("button",{onClick:m,className:"".concat(i.a.element," ").concat(i.a.button)},"Send Offer"))},w=function(e){var t=e.pseudo,n=Object(a.useState)(function(){var e=localStorage.getItem("marketIds");return e&&e.split("::")||[]}()),c=Object(o.a)(n,2),u=c[0],s=c[1],l=Object(a.useState)([]),m=Object(o.a)(l,2),v=m[0],b=m[1],w=Object(a.useCallback)(Object(d.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(u.map(function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:t=e.sent,b(t.filter((function(e){return null!==e})));case 4:case"end":return e.stop()}}),e)}))),[u]);Object(a.useEffect)((function(){Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))()}),[u,w]);return Object(a.useEffect)((function(){!function(e){localStorage.setItem("marketIds",e.join("::"))}(u)}),[u]),r.a.createElement("div",null,r.a.createElement(O,{pseudo:t,marketIds:u,refreshMarkets:w}),v.length>0&&r.a.createElement("div",{className:i.a.wrapper},r.a.createElement("h3",null,"Current Offers"),v.map((function(e){return r.a.createElement("div",{key:e.id,className:i.a.element},r.a.createElement(E,{market:e}))}))),r.a.createElement(k,{addMarketId:function(e){return s([].concat(Object(p.a)(u),[e]))}}))},j=n(7),g=n.n(j),x=function(){var e=Object(a.useState)(localStorage.getItem("pseudo")),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){n&&localStorage.setItem("pseudo",n)}),[n]),r.a.createElement("div",{className:g.a.appWrapper},r.a.createElement("header",null,r.a.createElement("h1",null,"Turnip Market"),n&&r.a.createElement("h2",null,r.a.createElement("span",{role:"img","aria-label":"Hello"},"\ud83d\udc4b")," ",n)),r.a.createElement("div",{className:g.a.content},n?r.a.createElement(w,{pseudo:n}):r.a.createElement(l,{setPseudo:c})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports={appWrapper:"App_appWrapper__-xe7_",content:"App_content__1dlDM"}}},[[11,1,2]]]);
//# sourceMappingURL=main.40cca169.chunk.js.map